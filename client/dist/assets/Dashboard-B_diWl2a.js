import{t as U}from"./helper-DKRQG75S.js";import{r as l,o as b,c as D,w as o,a as n,b as C,t as I,u as Y,d as L,e as N,f as k,g as A,m as J,h as d,I as j,F as M,i as P,j as K,k as Q,s as Z,l as ee,n as te,p as ne,q as G,v as z}from"./index-CVqkGovv.js";import{u as oe}from"./index-vzoNey9Z.js";var R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ae(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var le="Expected a function",H=NaN,re="[object Symbol]",se=/^\s+|\s+$/g,ie=/^[-+]0x[0-9a-f]+$/i,ce=/^0b[01]+$/i,de=/^0o[0-7]+$/i,ue=parseInt,fe=typeof R=="object"&&R&&R.Object===Object&&R,me=typeof self=="object"&&self&&self.Object===Object&&self,pe=fe||me||Function("return this")(),ve=Object.prototype,_e=ve.toString,ye=Math.max,ge=Math.min,F=function(){return pe.Date.now()};function be(e,a,i){var r,v,h,u,s,f,m=0,_=!1,c=!1,S=!0;if(typeof e!="function")throw new TypeError(le);a=X(a)||0,W(i)&&(_=!!i.leading,c="maxWait"in i,h=c?ye(X(i.maxWait)||0,a):h,S="trailing"in i?!!i.trailing:S);function y(t){var p=r,x=v;return r=v=void 0,m=t,u=e.apply(x,p),u}function g(t){return m=t,s=setTimeout(w,a),_?y(t):u}function $(t){var p=t-f,x=t-m,q=a-p;return c?ge(q,h-x):q}function T(t){var p=t-f,x=t-m;return f===void 0||p>=a||p<0||c&&x>=h}function w(){var t=F();if(T(t))return O(t);s=setTimeout(w,$(t))}function O(t){return s=void 0,S&&r?y(t):(r=v=void 0,u)}function B(){s!==void 0&&clearTimeout(s),m=0,r=f=v=s=void 0}function E(){return s===void 0?u:O(F())}function V(){var t=F(),p=T(t);if(r=arguments,v=this,f=t,p){if(s===void 0)return g(f);if(c)return s=setTimeout(w,a),y(f)}return s===void 0&&(s=setTimeout(w,a)),u}return V.cancel=B,V.flush=E,V}function W(e){var a=typeof e;return!!e&&(a=="object"||a=="function")}function he(e){return!!e&&typeof e=="object"}function xe(e){return typeof e=="symbol"||he(e)&&_e.call(e)==re}function X(e){if(typeof e=="number")return e;if(xe(e))return H;if(W(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=W(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=e.replace(se,"");var i=ce.test(e);return i||de.test(e)?ue(e.slice(2),i?2:8):ie.test(e)?H:+e}var Ce=be;const ke=ae(Ce),Se={__name:"DeleteModal",props:{title:String,text:String,actionBtnText:String,isLoading:Boolean},emits:["cancel","delete"],setup(e){return(a,i)=>{const r=l("v-card-text"),v=l("v-spacer"),h=l("v-btn"),u=l("v-card-actions"),s=l("v-card");return b(),D(s,{title:e.title},{default:o(()=>[n(r,null,{default:o(()=>[C(I(e.text),1)]),_:1}),n(u,null,{default:o(()=>[n(v),n(h,{variant:"outlined",text:"Cancel",onClick:i[0]||(i[0]=f=>a.$emit("cancel"))}),n(h,{loading:e.isLoading,disabled:e.isLoading,variant:"tonal",text:e.actionBtnText,color:"error",onClick:i[1]||(i[1]=f=>a.$emit("delete"))},null,8,["loading","disabled","text"])]),_:1})]),_:1},8,["title"])}}},we={class:"flex justify-between items-center"},je={key:0,class:"opacity-60 font-bold ml-2"},$e={class:"flex mt-5 items-end justify-end gap-2"},Te={__name:"SurveyCard",props:{id:String,title:String,responsesCount:Number,createdAt:String,isClosed:Boolean},setup(e){const a=e,i=Y(),r={year:"numeric",month:"numeric",day:"numeric"},v=L(`https://survin.onrender.com/survey/${a.id}`),{text:h,copy:u,copied:s,isSupported:f}=oe({link:v}),m=L(!1),_=L(!1),c=async()=>{m.value=!0;try{await P.put(`/survey/${a.id}`,{isClosed:!a.isClosed}),i.go("/")}catch(y){U(y)}finally{m.value=!1}},S=async()=>{m.value=!0;try{await P.delete(`/survey/${a.id}`),i.go("/")}catch(y){U(y)}finally{m.value=!1}};return(y,g)=>{const $=l("v-btn"),T=l("v-list-item"),w=l("v-list"),O=l("v-menu"),B=l("v-card-title"),E=l("router-link"),V=l("v-card-text"),t=l("v-card"),p=l("v-dialog");return b(),N(M,null,[n(t,null,{default:o(()=>[n(B,null,{default:o(()=>[k("div",we,[k("p",null,[C(I(e.title)+" ",1),e.isClosed?(b(),N("span",je," - Closed - ")):A("",!0)]),n(O,null,{activator:o(({props:x})=>[n($,J(x,{size:"x-small",icon:"",variant:"text"}),{default:o(()=>[n(d(j),{icon:"ph:dots-three-outline-fill",width:"20"})]),_:2},1040)]),default:o(()=>[n(w,null,{default:o(()=>[n(T,{density:"compact",onClick:c},{prepend:o(()=>[n(d(j),{icon:"ph:x",width:"20"})]),default:o(()=>[C(" "+I(e.isClosed?"Re-open":"Close"),1)]),_:1}),n(T,{"base-color":"error",density:"compact",onClick:g[0]||(g[0]=()=>_.value=!0)},{prepend:o(()=>[n(d(j),{icon:"ph:trash",width:"20"})]),default:o(()=>[C(" Delete ")]),_:1})]),_:1})]),_:1})])]),_:1}),n(V,null,{default:o(()=>[k("p",null,I(e.responsesCount)+" "+I(e.responsesCount===1?"response":"responses"),1),k("p",null," created at: "+I(new Date(e.createdAt).toLocaleString("en-GB",r)),1),k("div",$e,[n(E,{to:`/responses/${e.id}`},{default:o(()=>[n($,{color:"primary",variant:"outlined",onClick:()=>{}},{default:o(()=>[n(d(j),{icon:"ph:info",width:"20"}),C(" Responses ")]),_:1})]),_:1},8,["to"]),n($,{color:"primary",disabled:e.isClosed,flat:"",onClick:g[1]||(g[1]=()=>d(u)(v.value))},{default:o(()=>[n(d(j),{icon:d(s)?"ph:check":"ph:copy",width:"20"},null,8,["icon"]),C(" "+I(d(s)?"Copied":"Copy link"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1}),n(p,{modelValue:_.value,"onUpdate:modelValue":g[3]||(g[3]=x=>_.value=x),width:"500"},{default:o(()=>[n(Se,{title:`Delete survey '${e.title}'?`,onCancel:g[2]||(g[2]=()=>_.value=!1),onDelete:S,text:"are you sure you want to delete this survey? all responses and data related to this survey will be lost can't be retrieved again.","action-btn-text":"Delete","is-loading":m.value},null,8,["title","is-loading"])]),_:1},8,["modelValue"])],64)}}},Ve={class:"flex justify-between items-center my-5"},De=k("h1",null,"Your surveys",-1),Ie={class:"w-1/3 flex justify-end"},Oe={class:"flex mt-2 justify-end justify-self-end gap-2"},Ne={__name:"Dashboard",setup(e){const{mdAndUp:a}=K(),i=Q(),{searchWord:r}=Z(i),v=ee(),h=Y(),u=L(Number(v.query.page)||1),s=L([]),f=L(!1),m=async()=>{f.value=!0;try{const _=await P.get("/survey/my-surveys",{params:{title:r.value||"",limit:9,sortBy:"createdAt:desc",page:u.value}});s.value=_.data}catch(_){U(_)}finally{f.value=!1}};return te(async()=>{await m()}),ne(r,ke(()=>{m()},500)),(_,c)=>{const S=l("v-text-field"),y=l("v-btn"),g=l("v-card-title"),$=l("v-card-text"),T=l("v-card"),w=l("v-dialog"),O=l("v-skeleton-loader"),B=l("v-col"),E=l("v-row"),V=l("v-pagination");return b(),N(M,null,[k("div",Ve,[De,k("div",Ie,[d(a)?(b(),D(S,{key:0,modelValue:d(r),"onUpdate:modelValue":c[0]||(c[0]=t=>G(r)?r.value=t:null),clearable:"",color:"primary",rounded:"",placeholder:"Search","hide-details":"",density:"compact"},{"append-inner":o(()=>[n(d(j),{icon:"ph:magnifying-glass",width:"25"})]),_:1},8,["modelValue"])):A("",!0),d(a)?A("",!0):(b(),D(w,{key:1},{activator:o(({props:t})=>[n(y,J(t,{variant:"text",icon:"",size:"small",rounded:"lg"}),{default:o(()=>[n(d(j),{icon:"ph:magnifying-glass",width:"25"})]),_:2},1040)]),default:o(({isActive:t})=>[n(T,null,{default:o(()=>[n(g,null,{default:o(()=>[C(" Search for survey ")]),_:1}),n($,null,{default:o(()=>[n(S,{clearable:"",modelValue:d(r),"onUpdate:modelValue":c[1]||(c[1]=p=>G(r)?r.value=p:null),variant:"outlined",color:"primary",rounded:"",placeholder:"Search","hide-details":"",density:"compact"},{"append-inner":o(()=>[n(d(j),{icon:"ph:magnifying-glass",width:"25"})]),_:1},8,["modelValue"]),k("div",Oe,[n(y,{color:"primary",onClick:()=>{r.value="",t.value=!1},variant:"outlined"},{default:o(()=>[C(" Cancel ")]),_:2},1032,["onClick"]),n(y,{color:"primary",onClick:p=>t.value=!1},{default:o(()=>[C(" Done ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:1}))])]),f.value?(b(),D(E,{key:0,class:""},{default:o(()=>[(b(),N(M,null,z(9,t=>n(B,{cols:"12",md:"4"},{default:o(()=>[n(O,{type:"card"})]),_:1})),64))]),_:1})):(b(),D(E,{key:1,class:""},{default:o(()=>[(b(!0),N(M,null,z(s.value.results,t=>(b(),D(B,{cols:"12",md:"4",key:t._id},{default:o(()=>[n(Te,{title:t.title,"responses-count":t.responsesCount,"is-closed":t.isClosed,"created-at":t.createdAt,id:t._id},null,8,["title","responses-count","is-closed","created-at","id"])]),_:2},1024))),128))]),_:1})),f.value?A("",!0):(b(),D(V,{key:2,class:"mt-10",modelValue:u.value,"onUpdate:modelValue":[c[2]||(c[2]=t=>u.value=t),c[3]||(c[3]=t=>d(h).replace({query:{page:u.value}}))],color:"primary",length:s.value.totalPages,rounded:"large"},null,8,["modelValue","length"]))],64)}}};export{Ne as default};
