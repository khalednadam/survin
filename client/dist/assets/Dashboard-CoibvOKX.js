import{r as l,o as y,c as D,w as n,a as t,b as k,t as I,u as X,d as Y,e as N,f as E,g as S,h as M,m as J,i as u,I as V,F,j as P,k as K,l as Q,s as Z,n as ee,p as te,q as ne,v as q,x as G}from"./index-9iHmKBEN.js";import{u as oe}from"./index-CKU4WFmW.js";var R=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ae(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var le="Expected a function",z=NaN,re="[object Symbol]",se=/^\s+|\s+$/g,ie=/^[-+]0x[0-9a-f]+$/i,ce=/^0b[01]+$/i,de=/^0o[0-7]+$/i,ue=parseInt,fe=typeof R=="object"&&R&&R.Object===Object&&R,me=typeof self=="object"&&self&&self.Object===Object&&self,pe=fe||me||Function("return this")(),ve=Object.prototype,_e=ve.toString,ye=Math.max,ge=Math.min,U=function(){return pe.Date.now()};function be(e,a,i){var p,c,v,g,s,d,b=0,h=!1,f=!1,m=!0;if(typeof e!="function")throw new TypeError(le);a=H(a)||0,W(i)&&(h=!!i.leading,f="maxWait"in i,v=f?ye(H(i.maxWait)||0,a):v,m="trailing"in i?!!i.trailing:m);function w(r){var o=p,x=c;return p=c=void 0,b=r,g=e.apply(x,o),g}function j(r){return b=r,s=setTimeout(C,a),h?w(r):g}function _(r){var o=r-d,x=r-b,L=a-o;return f?ge(L,v-x):L}function $(r){var o=r-d,x=r-b;return d===void 0||o>=a||o<0||f&&x>=v}function C(){var r=U();if($(r))return O(r);s=setTimeout(C,_(r))}function O(r){return s=void 0,m&&p?w(r):(p=c=void 0,g)}function A(){s!==void 0&&clearTimeout(s),b=0,p=d=c=s=void 0}function B(){return s===void 0?g:O(U())}function T(){var r=U(),o=$(r);if(p=arguments,c=this,d=r,o){if(s===void 0)return j(d);if(f)return s=setTimeout(C,a),w(d)}return s===void 0&&(s=setTimeout(C,a)),g}return T.cancel=A,T.flush=B,T}function W(e){var a=typeof e;return!!e&&(a=="object"||a=="function")}function he(e){return!!e&&typeof e=="object"}function xe(e){return typeof e=="symbol"||he(e)&&_e.call(e)==re}function H(e){if(typeof e=="number")return e;if(xe(e))return z;if(W(e)){var a=typeof e.valueOf=="function"?e.valueOf():e;e=W(a)?a+"":a}if(typeof e!="string")return e===0?e:+e;e=e.replace(se,"");var i=ce.test(e);return i||de.test(e)?ue(e.slice(2),i?2:8):ie.test(e)?z:+e}var Ce=be;const ke=ae(Ce),Se={__name:"DeleteModal",props:{title:String,text:String,actionBtnText:String,isLoading:Boolean},emits:["cancel","delete"],setup(e){return(a,i)=>{const p=l("v-card-text"),c=l("v-spacer"),v=l("v-btn"),g=l("v-card-actions"),s=l("v-card");return y(),D(s,{title:e.title},{default:n(()=>[t(p,null,{default:n(()=>[k(I(e.text),1)]),_:1}),t(g,null,{default:n(()=>[t(c),t(v,{variant:"outlined",text:"Cancel",onClick:i[0]||(i[0]=d=>a.$emit("cancel"))}),t(v,{loading:e.isLoading,disabled:e.isLoading,variant:"tonal",text:e.actionBtnText,color:"error",onClick:i[1]||(i[1]=d=>a.$emit("delete"))},null,8,["loading","disabled","text"])]),_:1})]),_:1},8,["title"])}}},we={class:"flex justify-between items-center"},je={key:0,class:"opacity-60 font-bold ml-2"},$e={class:"flex mt-5 items-end justify-end gap-2"},Te={__name:"SurveyCard",props:{id:String,title:String,responsesCount:Number,createdAt:String,isClosed:Boolean},setup(e){const a=e,i=X(),p=Y(),c={year:"numeric",month:"numeric",day:"numeric"},v=N(`https://survin.app/survey/${a.id}`),{text:g,copy:s,copied:d,isSupported:b}=oe({link:v}),h=N(!1),f=N(!1),m=async()=>{h.value=!0;try{await P.put(`/survey/${a.id}`,{isClosed:!a.isClosed}),i.go("/")}catch{}finally{h.value=!1}},w=async()=>{h.value=!0;try{await P.delete(`/survey/${a.id}`),i.go("/")}catch{p.error("An error occurred")}finally{h.value=!1}};return(j,_)=>{const $=l("v-btn"),C=l("v-list-item"),O=l("v-list"),A=l("v-menu"),B=l("v-card-title"),T=l("router-link"),r=l("v-card-text"),o=l("v-card"),x=l("v-dialog");return y(),E(F,null,[t(o,null,{default:n(()=>[t(B,null,{default:n(()=>[S("div",we,[S("p",null,[k(I(e.title)+" ",1),e.isClosed?(y(),E("span",je," - Closed - ")):M("",!0)]),t(A,null,{activator:n(({props:L})=>[t($,J(L,{size:"x-small",icon:"",variant:"text"}),{default:n(()=>[t(u(V),{icon:"ph:dots-three-outline-fill",width:"20"})]),_:2},1040)]),default:n(()=>[t(O,null,{default:n(()=>[t(C,{density:"compact",onClick:m},{prepend:n(()=>[t(u(V),{icon:"ph:x",width:"20"})]),default:n(()=>[k(" "+I(e.isClosed?"Re-open":"Close"),1)]),_:1}),t(C,{"base-color":"error",density:"compact",onClick:_[0]||(_[0]=()=>f.value=!0)},{prepend:n(()=>[t(u(V),{icon:"ph:trash",width:"20"})]),default:n(()=>[k(" Delete ")]),_:1})]),_:1})]),_:1})])]),_:1}),t(r,null,{default:n(()=>[S("p",null,I(e.responsesCount)+" "+I(e.responsesCount===1?"response":"responses"),1),S("p",null," created at: "+I(new Date(e.createdAt).toLocaleString("en-GB",c)),1),S("div",$e,[t(T,{to:`/responses/${e.id}`},{default:n(()=>[t($,{color:"primary",variant:"outlined",onClick:()=>{}},{default:n(()=>[t(u(V),{icon:"ph:info",width:"20"}),k(" Responses ")]),_:1})]),_:1},8,["to"]),t($,{color:"primary",disabled:e.isClosed,flat:"",onClick:_[1]||(_[1]=()=>u(s)(v.value))},{default:n(()=>[t(u(V),{icon:u(d)?"ph:check":"ph:copy",width:"20"},null,8,["icon"]),k(" "+I(u(d)?"Copied":"Copy link"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1}),t(x,{modelValue:f.value,"onUpdate:modelValue":_[3]||(_[3]=L=>f.value=L),width:"500"},{default:n(()=>[t(Se,{title:`Delete survey '${e.title}'?`,onCancel:_[2]||(_[2]=()=>f.value=!1),onDelete:w,text:"are you sure you want to delete this survey? all responses and data related to this survey will be lost can't be retrieved again.","action-btn-text":"Delete","is-loading":h.value},null,8,["title","is-loading"])]),_:1},8,["modelValue"])],64)}}},Ve={class:"flex justify-between items-center my-5"},De=S("h1",null,"Your surveys",-1),Ie={class:"w-1/3 flex justify-end"},Oe={class:"flex mt-2 justify-end justify-self-end gap-2"},Ne={__name:"Dashboard",setup(e){const{mdAndUp:a}=K(),i=Q(),p=Y(),{searchWord:c}=Z(i),v=ee(),g=X(),s=N(Number(v.query.page)||1),d=N([]),b=N(!1),h=async()=>{b.value=!0;try{const f=await P.get("/survey/my-surveys",{params:{title:c.value||"",limit:9,sortBy:"createdAt:desc",page:s.value}});d.value=f.data}catch{p.error("An error occurred")}finally{b.value=!1}};return te(async()=>{await h()}),ne(c,ke(()=>{h()},500)),(f,m)=>{const w=l("v-text-field"),j=l("v-btn"),_=l("v-card-title"),$=l("v-card-text"),C=l("v-card"),O=l("v-dialog"),A=l("v-skeleton-loader"),B=l("v-col"),T=l("v-row"),r=l("v-pagination");return y(),E(F,null,[S("div",Ve,[De,S("div",Ie,[u(a)?(y(),D(w,{key:0,modelValue:u(c),"onUpdate:modelValue":m[0]||(m[0]=o=>q(c)?c.value=o:null),clearable:"",color:"primary",rounded:"",placeholder:"Search","hide-details":"",density:"compact"},{"append-inner":n(()=>[t(u(V),{icon:"ph:magnifying-glass",width:"25"})]),_:1},8,["modelValue"])):M("",!0),u(a)?M("",!0):(y(),D(O,{key:1},{activator:n(({props:o})=>[t(j,J(o,{variant:"text",icon:"",size:"small",rounded:"lg"}),{default:n(()=>[t(u(V),{icon:"ph:magnifying-glass",width:"25"})]),_:2},1040)]),default:n(({isActive:o})=>[t(C,null,{default:n(()=>[t(_,null,{default:n(()=>[k(" Search for survey ")]),_:1}),t($,null,{default:n(()=>[t(w,{clearable:"",modelValue:u(c),"onUpdate:modelValue":m[1]||(m[1]=x=>q(c)?c.value=x:null),variant:"outlined",color:"primary",rounded:"",placeholder:"Search","hide-details":"",density:"compact"},{"append-inner":n(()=>[t(u(V),{icon:"ph:magnifying-glass",width:"25"})]),_:1},8,["modelValue"]),S("div",Oe,[t(j,{color:"primary",onClick:()=>{c.value="",o.value=!1},variant:"outlined"},{default:n(()=>[k(" Cancel ")]),_:2},1032,["onClick"]),t(j,{color:"primary",onClick:x=>o.value=!1},{default:n(()=>[k(" Done ")]),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024)]),_:1}))])]),b.value?(y(),D(T,{key:0,class:""},{default:n(()=>[(y(),E(F,null,G(9,o=>t(B,{cols:"12",md:"4"},{default:n(()=>[t(A,{type:"card"})]),_:1})),64))]),_:1})):(y(),D(T,{key:1,class:""},{default:n(()=>[(y(!0),E(F,null,G(d.value.results,o=>(y(),D(B,{cols:"12",md:"4",key:o._id},{default:n(()=>[t(Te,{title:o.title,"responses-count":o.responsesCount,"is-closed":o.isClosed,"created-at":o.createdAt,id:o._id},null,8,["title","responses-count","is-closed","created-at","id"])]),_:2},1024))),128))]),_:1})),b.value?M("",!0):(y(),D(r,{key:2,class:"mt-10",modelValue:s.value,"onUpdate:modelValue":[m[2]||(m[2]=o=>s.value=o),m[3]||(m[3]=o=>u(g).replace({query:{page:s.value}}))],color:"primary",length:d.value.totalPages,rounded:"large"},null,8,["modelValue","length"]))],64)}}};export{Ne as default};
