import{t as F}from"./helper-CF1B-iET.js";import{r as s,o as b,c as D,w as o,a as t,b as j,t as S,u as H,d as $,e as E,f as T,g as X,m as Y,h as x,I as B,F as V,i as P,j as J,s as K,k as Q,l as Z,n as ee,p as U}from"./index-CtdDR2Pe.js";import{u as te}from"./index-VL2wMkp8.js";var N=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ne(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var oe="Expected a function",q=NaN,ae="[object Symbol]",re=/^\s+|\s+$/g,le=/^[-+]0x[0-9a-f]+$/i,se=/^0b[01]+$/i,ie=/^0o[0-7]+$/i,ce=parseInt,ue=typeof N=="object"&&N&&N.Object===Object&&N,de=typeof self=="object"&&self&&self.Object===Object&&self,fe=ue||de||Function("return this")(),me=Object.prototype,pe=me.toString,ve=Math.max,ye=Math.min,M=function(){return fe.Date.now()};function _e(e,n,l){var m,p,d,u,a,f,i=0,v=!1,h=!1,k=!0;if(typeof e!="function")throw new TypeError(oe);n=z(n)||0,W(l)&&(v=!!l.leading,h="maxWait"in l,d=h?ve(z(l.maxWait)||0,n):d,k="trailing"in l?!!l.trailing:k);function _(r){var g=m,C=p;return m=p=void 0,i=r,u=e.apply(C,g),u}function y(r){return i=r,a=setTimeout(w,n),v?_(r):u}function c(r){var g=r-f,C=r-i,G=n-g;return h?ye(G,d-C):G}function I(r){var g=r-f,C=r-i;return f===void 0||g>=n||g<0||h&&C>=d}function w(){var r=M();if(I(r))return L(r);a=setTimeout(w,c(r))}function L(r){return a=void 0,k&&m?_(r):(m=p=void 0,u)}function R(){a!==void 0&&clearTimeout(a),i=0,m=f=p=a=void 0}function A(){return a===void 0?u:L(M())}function O(){var r=M(),g=I(r);if(m=arguments,p=this,f=r,g){if(a===void 0)return y(f);if(h)return a=setTimeout(w,n),_(f)}return a===void 0&&(a=setTimeout(w,n)),u}return O.cancel=R,O.flush=A,O}function W(e){var n=typeof e;return!!e&&(n=="object"||n=="function")}function ge(e){return!!e&&typeof e=="object"}function be(e){return typeof e=="symbol"||ge(e)&&pe.call(e)==ae}function z(e){if(typeof e=="number")return e;if(be(e))return q;if(W(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=W(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=e.replace(re,"");var l=se.test(e);return l||ie.test(e)?ce(e.slice(2),l?2:8):le.test(e)?q:+e}var he=_e;const Ce=ne(he),xe={__name:"DeleteModal",props:{title:String,text:String,actionBtnText:String,isLoading:Boolean},emits:["cancel","delete"],setup(e){return(n,l)=>{const m=s("v-card-text"),p=s("v-spacer"),d=s("v-btn"),u=s("v-card-actions"),a=s("v-card");return b(),D(a,{title:e.title},{default:o(()=>[t(m,null,{default:o(()=>[j(S(e.text),1)]),_:1}),t(u,null,{default:o(()=>[t(p),t(d,{variant:"outlined",text:"Cancel",onClick:l[0]||(l[0]=f=>n.$emit("cancel"))}),t(d,{loading:e.isLoading,disabled:e.isLoading,variant:"tonal",text:e.actionBtnText,color:"error",onClick:l[1]||(l[1]=f=>n.$emit("delete"))},null,8,["loading","disabled","text"])]),_:1})]),_:1},8,["title"])}}},ke={class:"flex justify-between items-center"},Se={key:0,class:"opacity-60 font-bold ml-2"},we={class:"flex mt-5 items-end justify-end gap-2"},je={__name:"SurveyCard",props:{id:String,title:String,responsesCount:Number,createdAt:String,isClosed:Boolean},setup(e){const n=e,l=H(),m={year:"numeric",month:"numeric",day:"numeric"},p=$(`https://survin.onrender.com/survey/${n.id}`),{text:d,copy:u,copied:a,isSupported:f}=te({link:p}),i=$(!1),v=$(!1),h=async()=>{i.value=!0;try{await P.put(`/survey/${n.id}`,{isClosed:!n.isClosed}),l.go("/")}catch(_){F(_)}finally{i.value=!1}},k=async()=>{i.value=!0;try{await P.delete(`/survey/${n.id}`),l.go("/")}catch(_){F(_)}finally{i.value=!1}};return(_,y)=>{const c=s("v-btn"),I=s("v-list-item"),w=s("v-list"),L=s("v-menu"),R=s("v-card-title"),A=s("router-link"),O=s("v-card-text"),r=s("v-card"),g=s("v-dialog");return b(),E(V,null,[t(r,null,{default:o(()=>[t(R,null,{default:o(()=>[T("div",ke,[T("p",null,[j(S(e.title)+" ",1),e.isClosed?(b(),E("span",Se," - Closed - ")):X("",!0)]),t(L,null,{activator:o(({props:C})=>[t(c,Y(C,{size:"x-small",icon:"",variant:"text"}),{default:o(()=>[t(x(B),{icon:"ph:dots-three-outline-fill",width:"20"})]),_:2},1040)]),default:o(()=>[t(w,null,{default:o(()=>[t(I,{density:"compact",onClick:h},{prepend:o(()=>[t(x(B),{icon:"ph:x",width:"20"})]),default:o(()=>[j(" "+S(e.isClosed?"Re-open":"Close"),1)]),_:1}),t(I,{"base-color":"error",density:"compact",onClick:y[0]||(y[0]=()=>v.value=!0)},{prepend:o(()=>[t(x(B),{icon:"ph:trash",width:"20"})]),default:o(()=>[j(" Delete ")]),_:1})]),_:1})]),_:1})])]),_:1}),t(O,null,{default:o(()=>[T("p",null,S(e.responsesCount)+" "+S(e.responsesCount===1?"response":"responses"),1),T("p",null," created at: "+S(new Date(e.createdAt).toLocaleString("en-GB",m)),1),T("div",we,[t(A,{to:`/responses/${e.id}`},{default:o(()=>[t(c,{color:"primary",variant:"outlined",onClick:()=>{}},{default:o(()=>[t(x(B),{icon:"ph:info",width:"20"}),j(" Responses ")]),_:1})]),_:1},8,["to"]),t(c,{color:"primary",disabled:e.isClosed,flat:"",onClick:y[1]||(y[1]=()=>x(u)(p.value))},{default:o(()=>[t(x(B),{icon:x(a)?"ph:check":"ph:copy",width:"20"},null,8,["icon"]),j(" "+S(x(a)?"Copied":"Copy link"),1)]),_:1},8,["disabled"])])]),_:1})]),_:1}),t(g,{modelValue:v.value,"onUpdate:modelValue":y[3]||(y[3]=C=>v.value=C),width:"500"},{default:o(()=>[t(xe,{title:`Delete survey '${e.title}'?`,onCancel:y[2]||(y[2]=()=>v.value=!1),onDelete:k,text:"are you sure you want to delete this survey? all responses and data related to this survey will be lost can't be retrieved again.","action-btn-text":"Delete","is-loading":i.value},null,8,["title","is-loading"])]),_:1},8,["modelValue"])],64)}}},Te=T("h1",null,"Your surveys",-1),Be={__name:"Dashboard",setup(e){const n=J(),{searchWord:l}=K(n),m=Q(),p=H(),d=$(Number(m.query.page)||1),u=$([]),a=$(!1),f=async()=>{a.value=!0;try{const i=await P.get("/survey/my-surveys",{params:{title:l.value||"",limit:9,sortBy:"createdAt:desc",page:d.value}});u.value=i.data,console.log(i.data)}catch(i){F(i)}finally{a.value=!1}};return Z(async()=>{await f()}),ee(l,Ce(()=>{f()},500)),(i,v)=>{const h=s("v-skeleton-loader"),k=s("v-col"),_=s("v-row"),y=s("v-pagination");return b(),E(V,null,[Te,a.value?(b(),D(_,{key:0,class:"mt-8"},{default:o(()=>[(b(),E(V,null,U(9,c=>t(k,{cols:"12",md:"4"},{default:o(()=>[t(h,{type:"card"})]),_:1})),64))]),_:1})):(b(),D(_,{key:1,class:"mt-8"},{default:o(()=>[(b(!0),E(V,null,U(u.value.results,c=>(b(),D(k,{cols:"12",md:"4",key:c._id},{default:o(()=>[t(je,{title:c.title,"responses-count":c.responsesCount,"is-closed":c.isClosed,"created-at":c.createdAt,id:c._id},null,8,["title","responses-count","is-closed","created-at","id"])]),_:2},1024))),128))]),_:1})),a.value?X("",!0):(b(),D(y,{key:2,class:"mt-10",modelValue:d.value,"onUpdate:modelValue":[v[0]||(v[0]=c=>d.value=c),v[1]||(v[1]=c=>x(p).replace({query:{page:d.value}}))],color:"primary",length:u.value.totalPages,rounded:"large"},null,8,["modelValue","length"]))],64)}}};export{Be as default};
